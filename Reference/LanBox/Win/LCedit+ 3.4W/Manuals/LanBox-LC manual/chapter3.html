<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"><html>	<head>		<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">		<meta name="generator" content="Adobe GoLive 4">		<title>Under the hood of a LanBox-LC</title>	</head>	<body bgcolor="white" background="Images/backgroundgrey.gif">		<table border="0" cellspacing="0" cellpadding="0" width="600">			<tr>				<td valign="top" width="135"><a href="http://www.cds.nl/"><img src="Images/cdslogowit.gif" width="125" height="75" border="0" align="left"></a>&nbsp;</td>				<td valign="top" align="left" width="465">					<div align="right">						<b><br>						&nbsp;LanBox-LC manual v2.0b1</b></div>					<div align="left">						<p><font size="5"><b>What's under the hood</b><br>						</font>&nbsp;</div>				</td>			</tr>		</table>		<table border="0" cellspacing="0" cellpadding="0" width="600">			<tr>				<td valign="top" width="135">					<hr noshade size="1">					&nbsp;</td>			</tr>		</table>		<table border="0" cellspacing="0" cellpadding="0" width="600">			<tr>				<td valign="top" width="135"><b>Index</b>					<p><a href="chapter1.html"><font size="2"><b>Introduction</b></font></a><font size="2"><b><br>					&nbsp;</b></font><a href="chapter1.html#1"><font size="2">What's in the box</font></a><font size="2"><br>					&nbsp;<a href="chapter1.html#2">What's not in the box</a><br>					&nbsp;<a href="chapter1.html#3">New versions &amp; support</a> </font></p>					<p><a href="chapter2.html"><font size="2"><b>Getting started</b></font></a><font size="2"><b><br>					&nbsp;</b></font><a href="chapter2.html#1"><font size="2">Macintosh network setup</font></a><font size="2"><br>					&nbsp;<a href="chapter2.html#2">PC/Mac Serial setup</a><br>					&nbsp;<a href="chapter2.html#3">MIDI setup<br>					</a>&nbsp;<a href="chapter2.html#4">The LanBox</a><br>					&nbsp;<a href="chapter2.html#5">Software to use<br>					</a>&nbsp;<a href="chapter2.html#6">About fixtures &amp; DMX</a> </font></p>					<p><a href="chapter3.html"><font size="2"><b>What's under the hood<br>					</b></font></a><font size="2"><b>&nbsp;</b><a href="#1">LCII firmware operation</a><br>					&nbsp;<a href="#2">LC+ firmware operation</a> </font></p>					<p><a href="chapter4.html"><font size="2"><b>Using MIDI or Serial</b></font></a><font size="2"><b><br>					&nbsp;</b></font><a href="chapter4.html#1"><font size="2">MIDI communications</font></a><font size="2"><br>					&nbsp;<a href="chapter4.html#2">Serial communications</a><br>					</font><font size="2">&nbsp;<a href="chapter4.html#5">Contact/button trggers</a></font></p>					<p><a href="chapter5.html"><font size="2"><b>FAQ and Specs</b></font></a><b><font size="2"><br>					&nbsp;</font></b><font size="2"><a href="chapter5.html#1">LanBox FAQ</a><br>					&nbsp;<a href="chapter5.html#2">DMX FAQ</a><br>					&nbsp;<a href="chapter5.html#3">CE &amp; FCC specs</a> </font></td>				<td valign="top" width="465" align="left"><b>The electronics in the LanBox-LC</b>					<p>The LanBox-LC houses an industrial based embedded microprocessor system, with the following features:</p>					<ul>						<li type="disc">128 KB FlashPROM, enables easy upgrading of firmware.						<li type="disc">128 KB, nonvolatile memory, good for storage of hundreds of scenes.						<li type="disc">64 KB, volatile scene memory (used for uploaded temporary scenes).						<li type="disc">Balanced, filtered and spike protected DMX output (conforms to DMX-512 USITT 1990 protocol), with diagnostic LED.						<li type="disc">Transformer isolated network ports, with 200kb/sec data rate (PhoneNet compatible).						<li type="disc">High speed (38400 b/sec) RS422 communication port, for serial and MIDI usage.						<li type="disc">Switching power supply with large input range (11..18V) and high efficiency.						<li type="disc">Black extruded aluminum case, designed to withstand On-The-Road conditions.						<li type="disc">CE and FCC approved, so low radiation and highly sustainable to RFI.					</ul>					<p><img height="160" width="115" src="Images/underthehood.jpg" align="right">The electronics of the LanBox-LC is built with standard industrial printed circuit boards. The lower board contains all connectors to the outside world, the switching power supply , the network isolation transformer and buffer drivers for network and DMX. The top board contain a complete microcomputer system, including RAM, ROM, FlashPROM, nonvolatile RAM module and communication chips.</p>					<p>As you can see, there is quite some space left at the back part of the box. This space is reserved for extra optional i/o boards like analog outputs, relay outputs etc. We do not (yet) offer this options, but if there is enough demand, we might ;-)</p>					<p>On the top printed circuit board you see (besides all kind of electronic components) a small push button. If you ever loose your password this button can save you. When pressing it for more then five seconds, when the box is powered, it clears ALL memory including the password.</p>					<p><b>Note: When you have cleared the LanBox-LC with this button, the password is 0 (zero), the name of the box is &quot;IMC720&quot; and ALL lighting settings and programs (including the firmware) are gone.</b></p>					<p>&nbsp;<br>					&nbsp;</td>			</tr>		</table>		<table border="0" cellspacing="0" cellpadding="0" width="600">			<tr>				<td valign="top" width="135"><b>&nbsp;</b></td>				<td valign="top" width="465" align="left"><a name="1"></a><b>The operation of the LCII firmware</b>					<p>The LanBox-LC is a microprocessor based device, in other words a small computer. Like any computer it needs software to do something. This kind of software is often referred to as firmware.</p>					<p>When we ship a LanBox-LC&nbsp;we'll always load the latest LCII software into the box. New LCII firmware can be loaded into the LanBox-LC using the LCtools program (that comes with the LanBox-LCII installer). New versions of the LanBox-LC firmware will appear on our web site and can be downloaded for free.</p>					<p>LanBox-LC data flow<br>					You only need to read this part if you want to use manual override (Exceptions) and special applications (or if you're simply interested in how the LanBox-LC works). If you just want to select some nice scenes to go along with your presentation and you're not interested in the inner workings, don't bother to read on.</p>					<p>The LanBox-LCII firmware allows you to select scenes and to override DMX channels from three different sources (AppleTalk, serial and MIDI). Because this can all be very confusing we'll start with a data flow diagram.</p>					<center>						<p><img src="Images/lcdiagram.gif" width="280" height="260"></p>					</center>					<p>There are two data buffers in the LanBox-LC, the sequence buffer and the edit buffer. The sequence buffer is used by the internal sequencer of the LCII. The edit buffer is used by LCedit II, MIDI and serial editing.</p>					<p>A scene can be selected through AppleTalk (LCedit, XCMDs, MAX externals), serial (Windows 95), MIDI&nbsp;and even by the sequencer itself (when the total hold time for the current scene has passed, the sequencer selects the next one). The LanBox-LC II firmware collects the scene data from its memory.</p>					<p>The scene data is passed to the Sequencer / Transition manager unit, that will make the calculations for the transitions and updates the Sequence buffer every 50 ms at 20 FPS (100 ms when at 10 FPS).</p>					<p>A scene can also be loaded through AppleTalk (LCedit, XCMDs, MAX externals), serial (Windows 95) and MIDI. You can only edit a scene after it has been loaded.</p>					<p>We now have two buffers holding data. The Mode / control buffer also controls the EDIT and SEQ switches. These switches can be set globally and for each individual light channel (these are then called exceptions). If the EDIT switch is closed for a light channel, the data from the Edit buffer will go to the output buffer. If the SEQ switch is closed for a DMX channel, the data from the Sequence buffer will go to the output buffer. If both switches are closed (called the MIX mode), the LanBox-LC program will take the highest value of the two buffers and put that value in the output buffer.</p>					<p>The output buffer can be read through AppleTalk and serial (not through MIDI). The Mode / control buffer can be written into through AppleTalk and serial and MIDI. When the MIDI software in the LanBox-LC is activated, the Mode / control is set to the MIX mode</p>					<p>The values that are to be written to the Mode / control buffer to set the switches are:</p>					<ul>						<li>0: No exception						<li>1: Disabled SEQ exception						<li>2: Disabled EDIT exception						<li>3: Disabled MIX exception						<li>4: --						<li>5: Enabled SEQ exception						<li>6: Enabled EDIT exception						<li>7: Enabled MIX exception					</ul>					<p>The switches can be set different for each individual DMX channel, making the LanBox-LC II very flexible. At startup the Global Mode is set to SEQ with no exceptions, which is what is most commonly used with simple select scene commands. When you start experimenting with the modes, take it step by step. Each mode has its own effect and combinations can be very confusing.</p>					<p>&nbsp;<br>					&nbsp;</td>			</tr>		</table>		<table border="0" cellspacing="0" cellpadding="0" width="600">			<tr>				<td valign="top" width="135"><b>&nbsp;</b></td>				<td valign="top" width="465" align="left"><a name="2"></a><b>The operation of the LC+ firmware</b>					<p>When we ship a LanBox-LC&nbsp;we'll always load the latest LCII software into the box. When you want to use the new LC+ firmware, it needs to be installed with LCedit+. New versions of the LanBox-LC+ firmware will appear on our web site and can be downloaded for free. Although the LC+ firmware is much more complex then the LCII, the LC+ data flow diagram appears very simple.</p>					<p><img height="250" width="220" src="Images/LCplusdiagram.gif" align="left"><b>LanBox-LC+ data flow<br>					</b>While the LCII uses the volatile memory to store mainly scenes, the LC+ has a fast file system in order to store and retrieve all kind of data. The file system made it possible to have variable number of channels in scenes, while the memory usage is very low.</p>					<p>An engine gets data delivered to it's light channel(s) as a result of a request from the sequencer to the file system or it's delivered by network or MIDI/serial commands. As a result of this, the status of a channel which has data will be &quot;enabled&quot; and (when &quot;Auto Output&quot; is on), the channel output is also switched on. As the result of new data, faders are started for each enabled channel .</p>					<p>The &quot;Enabled&quot; status of a channel marks that it is used and should be stored when inserting/appending/replacing a scene. The enabled status is cleared for all channels when the sequencer requests a new scene or by hand with the &quot;clear engine&quot; command.</p>					<p>When the output status of a channel is on, the data from the faders are fed into the mixer. The mixer works like layers in Photoshop and can be set for each layer (engine) to Copy, HTP, LTP and transparent mode. Engine A is the top layer (has the highest priority), while engine H is the lowest layer.</p>					<p><b>Note:</b> Each engine has a master output switch, in order to override the channel output switches. If you turn off the auto output and the master output you can view/edit scenes while the data is not going to the mixer (blind editing).</p>					<p>Post processing<br>					After the mixer the data of each light channel is mapped to a DMX channel (patcher), multiplied by the channel gain (channel masters), translated via a curve and limited in change rate (slope limiting). The resulting data is placed in the DMX output buffer and sent to the DMX cable 20 times per second.</p>					<p><b>The sequencers</b><br>					Each engine has it's own sequencer in order to automate loading of scenes or do special actions. A so called step (there are maximal 99 steps per cue list) contain instructions for the sequencer and can hold scene data when it is a scene instruction. The LanBox-LC+ has many possible actions (see reference manual), but most of the time they will be just scenes.</p>					<p>Each scene load activates faders with the fade time of the step instruction and is independent of the hold time of the step. This makes it possible to start at a certain time with completely different fade times for different channels or have different fade-in and -out times for a cross fade.</p>					<p>Once a sequencer is enabled (Run) and it has been &quot;Go&quot;ed, it keeps sequencing until the end of a cue list. When the Chaser is set it can keep on going depending of the chaser mode.</p>					<p>&nbsp;<br>					&nbsp;&nbsp;</td>			</tr>			<tr>				<td width="135">&nbsp;</td>				<td width="465">					<center>						<a href="chapter2.html">To previous section</a>, <a href="chapter4.html">To next section</a>&nbsp;						<p><a href="chapter1.html">Introduction</a> <b>|</b> <a href="chapter2.html">Getting started</a> <b>|</b> <a href="chapter3.html">Under the hood</a> <b>|</b> <a href="chapter4.html">MIDI&amp;Serial</a> <b>|</b> <a href="chapter5.html">FAQ&amp;Specs</a></p>						<p>&nbsp;&nbsp;</center>				</td>			</tr>		</table>		<table width="600" border="0" cellspacing="0" cellpadding="0">			<tr>				<td colspan="2" valign="top">					<hr noshade size="1">				</td>			</tr>			<tr>				<td width="135" valign="top"><font size="1">Last updated: 31-07-2000<br>					by:&nbsp;Fokko</font></td>				<td valign="top" width="465"><font size="1">Copyright 1997..2000 CDS advanced technology bv. LanBox is a registered trademark of CDS advanced technology bv. All other names referenced are the service marks, trademarks or registered trademarks of their respective companies.<br>					Comments or suggestions: <a href="mailto:webmaster@cds.nl">webmaster@cds.nl</a> , Questions and info: <a href="mailto:info@cds.nl">info@cds.nl</a><a href="mailto:anyuser@cds.nl">.</a>&nbsp;</font></td>			</tr>			<tr>				<td colspan="2">					<hr noshade size="1">				</td>			</tr>		</table>		<br>		&nbsp;&nbsp;&nbsp;	</body></html>